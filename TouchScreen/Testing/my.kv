WindowManager:
    id: window_manager
    MainWindow:
        id: main_window
        manager: window_manager
    PlayGameWindow:
        id: playgame_window
        manager: window_manager
    LiveCalculationWindow:
        id: livecalcultaion_window
        manager: window_manager
    ColorDetectionWindow:
        id: colordetection_window
        manager: window_manager
    CalibrationWindow:
        id: calibration_window
        manager: window_manager
    SettingsWindow:
        id: settings_window
        manager: window_manager


<MainWindow>:
    name: "Main"

    Button:
        text: "Play game"
        size_hint: 0.5, 0.1
        pos_hint: {"center_x":0.5, "y":0.75}

        on_release:
            root.manager.transition.direction = "left"
            app.root.current = "Play_game"

    Button:
        text: "Live calculations"
        size_hint: 0.5, 0.1
        pos_hint: {"center_x":0.5, "y":0.6}

        on_release:
            root.manager.transition.direction = "left"
            app.root.current = "Live_calculation"

    Button:
        text: "Color detection"
        size_hint: 0.5, 0.1
        pos_hint: {"center_x":0.5, "y":0.45}

        on_release:
            root.manager.transition.direction = "left"
            app.root.current = "Color_detection"
            #root.GetColorsToColorWindow()

    Button:
        text: "Calibration"
        size_hint: 0.5, 0.1
        pos_hint: {"center_x":0.5, "y":0.3}

        on_release:
            root.manager.transition.direction = "left"
            app.root.current = "Calibration"

    Button:
        text: "Settings"
        size_hint: 0.5, 0.1
        pos_hint: {"center_x":0.5, "y":0.15}

        on_release:
            root.manager.transition.direction = "left"
            app.root.current = "Settings"

    Button:
        text: "Quit"
        size_hint: 0.15, 0.1
        pos_hint: {"center_x":0.9, "y":0.05}
        on_release:
            root.QuitApp()

<PlayGameWindow>:
    name: "Play_game"
    Button:
        size_hint: 0.5, 0.1
        pos_hint: {"center_x":0.5, "y":0.75}    
        text: "to main"
        on_release:
            root.manager.transition.direction = "right"
            app.root.current = "Main"        

    Button:
        text: "Solenoid"
        pos_hint: {"center_x":0.5, "y":0.1}
        size_hint: 0.2, 0.1
        on_press:
            # solenoid high    
        on_release:
            # solenoid low

    Button:
        text: "+"
        size_hint: 0.1, 0.1
        pos_hint: {"center_x":0.2, "y":0.5}    
        on_release:
            root.ScorePlayer(1)
    Button:
        text: "-"
        size_hint: 0.1, 0.1
        pos_hint: {"center_x":0.35, "y":0.5}    
        on_release:
            root.ScorePlayer(-1)

    Label:
        id: score_player
        font_size: root.font_size_score
        pos_hint: {"center_x":0.5, "y":0.3}
        size_hint: 0.2, 0.2
        text: "0"

    Button:
        text: "+"
        size_hint: 0.1, 0.1
        pos_hint: {"center_x":0.5, "y":0.5}    
        on_release:
            root.ScoreRobot(1)
    Button:
        text: "-"
        size_hint: 0.1, 0.1
        pos_hint: {"center_x":0.65, "y":0.5}    
        on_release:
            root.ScoreRobot(-1)
    Label:
        id: score_robot
        font_size: root.font_size_score
        pos_hint: {"center_x":0.65, "y":0.3}
        size_hint: 0.2, 0.2
        text: "0"

    Label:
        font_size: root.font_size_score
        pos_hint: {"center_x":0.575, "y":0.32}
        size_hint: 0.2, 0.2
        text: ":"
    

<LiveCalculationWindow>:
    name: "Live_calculation"

    Button:
        text: "Go Back"
        on_release:
            root.manager.transition.direction = "right"
            app.root.current = "Main"

    Button:
        size_hint: 0.5, 0.1
        pos_hint: {"center_x":0.5, "y":0.5}
        text: "Hit me"
        on_release: root.Counter_function()

    Button:
        size_hint: 0.5, 0.1
        pos_hint: {"center_x":0.5, "y":0.3}
        text: "Thread"
        on_release: root.First_thread()

    Button:
        size_hint: 0.5, 0.1
        pos_hint: {"center_x":0.5, "y":0.0}
        text: "Thread"
        on_release: root.test()

    Label:
        size_hint: 0.5, 0.1
        pos_hint: {"center_x":0.5, "y":0.15}
        id: lbl
        text: "Numbers"

<ColorDetectionWindow>:
    name: "Color_detection"
    #slide_text_hue_min: slider_hue_min
    #slide_text_hue_max: slider_hue_max
    #slide_text_sat_min: slider_sat_min
    #slide_text_sat_max: slider_sat_max
    #slide_text_val_min: slider_val_min
    #slide_text_val_max: slider_val_max
    

    Button:
        text: "Go Back"
        size_hint: 0.2, 0.1
        pos_hint: {"center_x":0.15, "y":0.05}
        on_release:
            root.manager.transition.direction = "right"
            app.root.current = "Main"  
            root.StopCaptureThread()      

    Button:
        text: "Start color calibration"
        size_hint: 0.2, 0.1
        id: btn_start_color
        pos_hint: {"center_x":0.5, "y":0.05}
        on_release:
            root.CaptureThread()
            root.GetColors()


    Button:
        text: "Apply"
        size_hint: 0.2, 0.1
        id: btn_apply
        pos_hint: {"center_x": 0.85, "y":0.05}
        disabled: True
        on_release:
            root.UpdateColors()
            root.GetColors()
            root.StopCaptureThread()
            disabled: True


    Button:
        text: "Last values"
        size_hint: 0.15, 0.075
        pos_hint: {"center_x":0.875, "y":0.5}
        on_press:
            root.GetColors()
            root.ChangeHSVColor("LAST")

    Button:
        text: "Blue"
        size_hint: 0.15, 0.075
        pos_hint: {"center_x":0.875, "y":0.4}
        id: btn_blue
        on_press:
            root.GetColors()
            root.ChangeHSVColor("BLUE")
            #root.slide_hue_min(*args)

    Button:
        text: "Yellow"
        size_hint: 0.15, 0.075
        pos_hint: {"center_x":0.875, "y":0.3}
        on_press:
            root.GetColors()
            root.ChangeHSVColor("YELLOW")

    Button:
        text: "Green"
        size_hint: 0.15, 0.075
        pos_hint: {"center_x":0.875, "y":0.2}
        on_press:
            root.GetColors()
            root.ChangeHSVColor("GREEN")

    BoxLayout:
        orientation: "vertical"
        pos_hint: {"x": 0, "y": 0.6}
        size_hint: 0.8, 0.4

        Label:
            id: hue_min_label
            text: "Hue min: " + str(root.hue_min)
            pos_hint: {"x": 0.6, "y": 0}
            font_size: root.font_size
        Slider:
            min: 0
            max: 179
            id: hue_min_slider
            value: root.hue_min
            step: 1
            orientation: "horizontal"
            on_value: 
                root.slide_hue_min(*args)
                #root.thread()
                #root.updateImage()
        
        Label:
            id: hue_max_label
            text: "Hue max: " + str(root.hue_max)
            pos_hint: {"x":0.6, "y": 0}
            font_size: root.font_size
        Slider:
            min: 0
            max: 179
            id: hue_max_slider
            value: root.hue_max
            orientation: "horizontal"
            on_value: 
                root.slide_hue_max(*args)
                #root.thread()

        Label:
            id: sat_min_label
            text: "Sat min: " + str(root.sat_min)
            pos_hint: {"x":0.6, "y": 0}
            font_size: root.font_size
        Slider:
            min: 0
            max: 255
            id: sat_min_slider
            value: root.sat_min
            orientation: "horizontal"
            on_value: 
                root.slide_sat_min(*args)
                #root.thread()

        Label:
            id: sat_max_label
            text: "Sat max: " + str(root.sat_max)
            pos_hint: {"x":0.6, "y": 0}
            font_size: root.font_size
        Slider:
            min: 0
            max: 255
            id: sat_max_slider
            value: root.sat_max
            orientation: "horizontal"
            on_value: 
                root.slide_sat_max(*args)
                #root.thread()

        Label:
            id: val_min_label
            text: "Val min: " + str(root.val_min)
            pos_hint: {"x":0.6, "y": 0}
            font_size: root.font_size
        Slider:
            min: 0
            max: 255
            id: val_min_slider
            value: root.val_min
            orientation: "horizontal"
            on_value: 
                root.slide_val_min(*args)
                #root.thread()
        
        Label:
            id: val_max_label
            text: "Val max: " + str(root.val_max)
            pos_hint: {"x":0.6, "y": 0}
            font_size: root.font_size
        Slider:
            min: 0
            max: 255
            id: val_max_slider
            value: root.val_max
            orientation: "horizontal"
            on_value: 
                root.slide_val_max(*args)
                #root.thread()

    BoxLayout:
        orientation: "vertical"
        pos_hint: {"center_x": 0.5, "y": 0.2}
        size_hint: 0.6, 0.3

        Image:
            source: root.img_src
            id: image
            allow_stretch: False
            keep_ratio: False
        #Image:




<CalibrationWindow>:
    name: "Calibration"

    Button:
        text: "Back"
        size_hint: 0.15, 0.1
        pos_hint: {"center_x":0.1, "y":0.05}
        on_release:
            root.manager.transition.direction = "right"
            app.root.current = "Main"

    Button:
        text: "New homing"
        size_hint: 0.15, 0.1
        pos_hint: {"center_x":0.3, "y":0.05}
        on_release:
            
    Label:
        id: pos_x
        text: "X: "
        font_size: root.font_size_pos
        size_hint: 0.15, 0.1
        pos_hint: {"center_x":0.05, "y":0.88}
    Label:
        id: pos_y
        text: "Y: "
        font_size: root.font_size_pos
        size_hint: 0.15, 0.1
        pos_hint: {"center_x":0.05, "y":0.78}

    
    # NUMPAD
    BoxLayout:
        orientation: "horizontal"
        size_hint: 0.15, 0.1
        pos_hint: {"center_x": 0.9, "y": 0.72}
        TextInput:
            text: "0"
            font_size: 30
            id: text_x_pos
            halign: "right"
            foreground_color: 1, 0, 0
            
    BoxLayout:
        orientation: "horizontal"
        size_hint: 0.15, 0.1
        pos_hint: {"center_x": 0.9, "y": 0.62}
        TextInput:
            text: "0"
            font_size: 30
            id: text_y_pos
            halign: "right"
            foreground_color: 1,0,0
    Button:
        text: "GO TO"
        id: GoTo_btn
        font_size: root.font_size_buttons
        size_hint: 0.3, 0.1
        pos_hint: {"center_x": 0.825, "y": 0.84}
        color: 1,0,0
        on_release:
            root.GoTo_btn()
    Button:
        text: "X :"
        font_size: root.font_size_buttons
        size_hint: 0.13, 0.1
        pos_hint: {"center_x":0.74, "y":0.72}
        on_press:
            root.ChooseXYvalue(0)
    Button:
        text: "Y :"
        font_size: root.font_size_buttons
        size_hint: 0.13, 0.1
        pos_hint: {"center_x":0.74, "y":0.62}
        on_press:
            root.ChooseXYvalue(1)

    Button:
        text: "1"
        font_size: root.font_size_buttons
        size_hint: 0.1, 0.1
        pos_hint: {"center_x":0.725, "y":0.5}
        on_press:
            root.NumPadPress(1)
    Button:
        text: "2"
        font_size: root.font_size_buttons
        size_hint: 0.1, 0.1
        pos_hint: {"center_x":0.825, "y":0.5}
        on_press:
            root.NumPadPress(2)
    Button:
        text: "3"
        font_size: root.font_size_buttons
        size_hint: 0.1, 0.1
        pos_hint: {"center_x":0.925, "y":0.5}
        on_press:
            root.NumPadPress(3)
    Button:
        text: "4"
        font_size: root.font_size_buttons
        size_hint: 0.1, 0.1
        pos_hint: {"center_x":0.725, "y":0.4}
        on_press:
            root.NumPadPress(4)
    Button:
        text: "5"
        font_size: root.font_size_buttons
        size_hint: 0.1, 0.1
        pos_hint: {"center_x":0.825, "y":0.4}
        on_press:
            root.NumPadPress(5)
    Button:
        text: "6"
        font_size: root.font_size_buttons
        size_hint: 0.1, 0.1
        pos_hint: {"center_x":0.925, "y":0.4}
        on_press:
            root.NumPadPress(6)
    Button:
        text: "7"
        font_size: root.font_size_buttons
        size_hint: 0.1, 0.1
        pos_hint: {"center_x":0.725, "y":0.3}
        on_press:
            root.NumPadPress(7)
    Button:
        text: "8"
        font_size: root.font_size_buttons
        size_hint: 0.1, 0.1
        pos_hint: {"center_x":0.825, "y":0.3}
        on_press:
            root.NumPadPress(8)
    Button:
        text: "9"
        font_size: root.font_size_buttons
        size_hint: 0.1, 0.1
        pos_hint: {"center_x":0.925, "y":0.3}
        on_press:
            root.NumPadPress(7)
    Button:
        text: "CLEAR"
        font_size: root.font_size_buttons
        size_hint: 0.1, 0.1
        pos_hint: {"center_x":0.725, "y":0.2}
        on_press:
            root.NumPadPress(-1)
    Button:
        text: "0"
        font_size: root.font_size_buttons
        size_hint: 0.1, 0.1
        pos_hint: {"center_x":0.825, "y":0.2}
        on_press:
            root.NumPadPress(0)

<SettingsWindow>:
    name: "Settings"

    Button:
        text: "Go Back"
        on_release:
            root.manager.transition.direction = "right"
            app.root.current = "Main"


<GoToPopopWindow>:
    Label:
        text: "Out of boundaries!"
        size_hint: 0.6, 0.1
        pos_hint: {"center_x":0.5, "center_y":0.85}
        font_size: 17
    Label:
        text: "X: [ 70 , 620 ]"
        size_hint: 0.6, 0.1
        pos_hint: {"center_x":0.5, "center_y":0.65}
        font_size: 17
    Label:
        text: "Y: [ 65 , 735 ]"
        size_hint: 0.6, 0.1
        pos_hint: {"center_x":0.5, "center_y":0.5}
        font_size: 17
    Label:
        text: "Touch outside box to continue"
        size_hint: 0.6, 0.1
        pos_hint: {"center_x":0.5, "center_y":0.3}
        font_size: 17

    